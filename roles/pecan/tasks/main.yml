---
# tasks file for Pecan
- name: Add ncsa chart repo
  kubernetes.core.helm_repository:
    name: ncsa
    repo_url: https://opensource.ncsa.illinois.edu/charts/
- name: Add bitnami chart repo
  kubernetes.core.helm_repository:
    name: bitnami
    repo_url: https://raw.githubusercontent.com/bitnami/charts/pre-2022/bitnami
- name: Install postgresql service
  k8s:
    state: present
    kind: Service
    api_version: v1
    name: pecan-postgresql
    namespace: "{{ ansible_operator_meta.namespace }}"
    definition: "{{ lookup('template', 'service-pecan-postgres.yml') }}"
#
#- name: Add Pecan
#  kubernetes.core.helm:
#    name: pecan
#    chart_ref: ncsa/pecan
#    chart_version: 0.6.2
#    release_namespace: "{{ ansible_operator_meta.namespace }}"
#    release_state: present